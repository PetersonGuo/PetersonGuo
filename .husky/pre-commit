#!/bin/sh

RESUME_TEX="public/Peterson_Guo_Resume.tex"

# Sanitize resume contact info before building
if git diff --cached --name-only | grep -q "$RESUME_TEX"; then
  echo "ğŸ“ Sanitizing contact info in $RESUME_TEX..."

  # Replace contact info with empty values
  sed -i '' 's/\\providecommand{\\ResumePhone}{[^}]*}/\\providecommand{\\ResumePhone}{}/g' "$RESUME_TEX"
  sed -i '' 's/\\providecommand{\\ResumeEmail}{[^}]*}/\\providecommand{\\ResumeEmail}{}/g' "$RESUME_TEX"

  echo "âœ“ Contact info sanitized"
  
  # Build PDF from sanitized resume
  echo "ğŸ“ Building resume PDF..."
  node scripts/buildResume.js
  
  # Stage generated files
  git add "$RESUME_TEX" public/Peterson_Guo_Resume.pdf
  
  echo "âœ“ Resume built and staged"
fi
